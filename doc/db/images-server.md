# Images and Filesystem Collections

## Images Document Structure

| Field        | Type     | Description                                                      |
|--------------|----------|------------------------------------------------------------------|
| _id          | Number   | Unique ID generated by mongodb, primary key for this document    |
| uid          | ObjectId | Unique ID of the user that owns the image                        |
| fid          | ObjectId | Unique ID of file in GridFS Filesystem collection                |
| location     | String   | Path to the image on the server's filesystem (GridFS)            |
| metadata     | Object   | See below for structure                                          |
| shared       | Boolean  | Whether or not the image is publically visible                   |

### Metadata Structure

| Field        | Type     | Description                                                      |
|--------------|----------|------------------------------------------------------------------|
| rating       | Integer  | Rating of the image, on a scale of 0-5                           |
| tags         | Array    | Tags (strings) applied to this image                             |

## Filesystem Document Structure

This is known as `fs.files` in MongoDB

| Field        | Type     | Description                                                      |
|--------------|----------|------------------------------------------------------------------|
| _id          | ObjectId | Unique ID generated by mongodb, primary key for this document    |
| uploadDate   | ISODate  | See below for structure                                          |
| md5          | String   | MD5 checksum                                                     |
| filename     | String   | Literal filename on disk                                         |
| contentType  | String   | MIME type                                                        |
| length       | Number   | Size of the file                                                 |
| chunkSize    | Number   | Size of parts of the file on disk (fixed across the db)          |
| aliases      | Null     | Unused value                                                     |
| metadata     | Null     | Unused value, intended for storing user data                     |

## Example Image Document

```js
{
  "_id" : ObjectId("542c2b97bac0595474108b48"),
  "uid": ObjectId("5fgh2b97bac0595474108b48"),
  "hash" : "34123187ndf9813fhq9348",
  "location" : "/home/here.png",
  "metadata" : {"rating": 3, "tags": ["winter", "chill"]},
  "shared": false
}
```

## Example Filesystem Document

```js
{
  "_id" : ObjectId("58dcec924b315d1f46661476"),
  "uploadDate" : ISODate("2017-03-30T11:31:30.952Z"),
  "md5" : "5da00c42df15f3b4e6b724ca9b37659e",
  "filename" : "2a6f5bfcc868b2db95661361e34ac24f",
  "contentType" : "image/png",
  "length" : 66355,
  "chunkSize" : 261120,
  "aliases" : null,
  "metadata" : null
}
```
